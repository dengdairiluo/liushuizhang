# 高效能MySQL

## 1 查询响应时间

### 1.1 假性能的一个真故事

### 1.2 北极星

### 1.3 查询报告

#### 1.3.1 来源

#### 1.3.2 聚合

#### 1.3.3 报告

### 1.4 查询分析

#### 1.4.1 查询指标

#### 1.4.2 元数据和应用程序

#### 1.4.3 相对值

#### 1.4.4 平均值、百分位和最大值

### 1.5 改进查询响应时间

#### 1.5.1 直接查询优化

#### 1.5.2 间接查询优化

### 1.6 何时优化查询

#### 1.6.1 性能影响客户

#### 1.6.2 代码修改之前和之后

#### 1.6.3 一月一次

### 1.7 MySQL：更快一点

### 1.8 小结

### 1.9 练习：识别慢查询

## 2 索引和编制索引

### 2.1 性能的红鲱鱼

#### 2.1.1 更好、更快的硬件

#### 2.1.2 MySQL调优

### 2.2 MySQL索引：通过图示介绍

#### 2.2.1 InnoDB的表的是索引

#### 2.2.2 表访问方法

#### 2.2.3 最左前缀要求

#### 2.2.4 EXPLAIN：查询执行计划

#### 2.2.5 WHERE

#### 2.2.6 GROUP BY

#### 2.2.7 ORDER BY

#### 2.2.8 覆盖索引

#### 2.2.9 连接表

### 2.3 编制索引：如何像MySQL一样思考

#### 2.3.1 了解查询

#### 2.3.2 使用EXPLAIN帮助理解

#### 2.3.3 优化查询

#### 2.3.4 部署和验证

### 2.4 索引降级的常见原因

#### 2.4.1 查询改变

#### 2.4.2 过多、重复和未使用

#### 2.4.3 极端选择性

#### 2.4.4 选择错误的索引

### 2.5 表连接算法

### 2.6 小结

### 2.7 练习：找到重复的索引

## 3 数据

### 3.1 三个秘密

#### 3.1.1 索引可能没有帮助

#### 3.1.2 数据越少越好

#### 3.1.3 QPS越低越好

### 3.2 最少数据原则

#### 3.2.1 数据访问

#### 3.2.2 数据存储

### 3.3 删除或归档数据

#### 3.3.1 工具

#### 3.3.2 批大小

#### 3.3.3 行锁争用

#### 3.3.4 空间和时间

#### 3.3.5 二进制日志悖论

### 3.4 小结

### 3.5 练习：审查查询的数据访问情况

## 4 访问模式

### 4.1 MySQL什么都不做

### 4.2 性能在极限位置变得不稳定

### 4.3 丰田和法拉利

### 4.4 数据访问模式

#### 4.4.1 读/写

#### 4.4.2 吞吐量

#### 4.4.3 数据年龄

#### 4.4.4 数据模型

#### 4.4.5 事务隔离

#### 4.4.6 读一致性

#### 4.4.7 并发性

#### 4.4.8 行访问

#### 4.4.9 结果集

### 4.5 应用程序修改

#### 4.5.1 审查代码

#### 4.5.2 转移读取

#### 4.5.3 将写操作加入队列

#### 4.5.4 将数据分区

#### 4.5.5 不要使用MySQL

### 4.6 更好、更快的硬件

### 4.7 小结

### 4.8 练习：描述访问模式

## 5 分片

### 5.1 为什么单个数据库不能伸缩

#### 5.1.1 应用程序的工作负载

#### 5.1.2 基准是人为设计的

#### 5.1.3 写操作

#### 5.1.4 模式修改

#### 5.1.5 操作

### 5.2 小鹅卵石而不是巨石

### 5.3 分片简介

#### 5.3.1 分片键

#### 5.3.2 策略

#### 5.3.3 挑战

### 5.4 替代选项

#### 5.4.1 NewSQL

#### 5.4.2 中间件

#### 5.4.3 微服务

#### 5.4.4 不要使用MySQL

### 5.5 小结

### 5.6 练习：四年拟合

## 6 服务器指标

### 6.1 查询性能与服务器性能对比

### 6.2 正常且稳定：最好的数据库是枯燥的数据库

### 6.3 关键性能指示器

### 6.4 指标领域

#### 6.4.1 响应时间

#### 6.4.2 比率

#### 6.4.3 使用率

#### 6.4.4 等待

#### 6.4.5 错误率

#### 6.4.6 访问模式

#### 6.4.7 内部指标

### 6.5 光谱

#### 6.5.1 查询响应时间

#### 6.5.2 错误率

#### 6.5.3 查询

#### 6.5.4 线程和连接

#### 6.5.5 临时对象

#### 6.5.6 预处理语句

#### 6.5.7 不好的select

#### 6.5.8 网络吞吐量

#### 6.5.9 复制

#### 6.5.10 数据大小

#### 6.5.11 InnoDB
